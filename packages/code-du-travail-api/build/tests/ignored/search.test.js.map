{"version":3,"sources":["../../../src/tests/ignored/search.test.ts"],"sourcesContent":["import fs from \"fs\";\nimport type { SuperTest } from \"supertest\";\nimport supertest from \"supertest\";\n\nimport { app } from \"../..\";\n\nconst mostSearches = [\n  \"3239\", // popular\n  \"indemnités de licenciement\",\n  \"indemnité licenciement\",\n  \"congés payés\",\n  \"rupture conventionnelle cdi\",\n  \"licenciement\",\n  \"convention collective\",\n  \"heures supplémentaires\",\n  \"période d'essai\",\n  \"licenciement inaptitude\",\n  \"Préavis\",\n  \"Congés payés et fractionnement\",\n  \"Solde de tout compte\",\n  \"amiante\", // pré-qualifié\n  \"covid 19 (variante de coronavirus)\",\n  \"lettre de démission (variante de lettre-demission)\",\n  \"syntec\", // synonymes\n  \"1596\",\n  \"1597\",\n  \"HCR\",\n  \"particulier employeur\",\n  \"particuliers employeurs\",\n  \"assistantes maternelles\",\n  \"assistant maternel\",\n  \"convention collective assistante maternelle\",\n];\n\ndescribe(\"Search - Snapshot result\", () => {\n  let server: any;\n  let request: SuperTest<any>;\n\n  beforeAll(() => {\n    server = app.listen(3000);\n    request = supertest(server);\n  });\n\n  afterAll(() => {\n    server.close();\n  });\n\n  it(\"should be defined\", async () => {\n    const res = await request.get(\"/\");\n    expect(res.status).toBe(200);\n    expect(res.body).toStrictEqual({ message: \"running\" });\n  });\n\n  it.each(mostSearches)(\"should return a result for %s\", async (search) => {\n    const url = `/api/v1/search?q=${encodeURIComponent(search)}`;\n    const res = await request.get(url);\n    const documents = res.body.documents;\n    const result = documents.map((r: any) => ({\n      slug: r.slug,\n      source: r.source,\n    }));\n    fs.writeFileSync(\n      __dirname + `/search_results/${search.replace(/\\s/g, \"_\")}.json`,\n      JSON.stringify(result, null, 2)\n    );\n    expect(res.status).toBe(200);\n  });\n});\n"],"names":["fs","supertest","app","mostSearches","describe","server","request","beforeAll","listen","afterAll","close","it","res","get","expect","status","toBe","body","toStrictEqual","message","each","search","url","encodeURIComponent","documents","result","map","r","slug","source","writeFileSync","__dirname","replace","JSON","stringify"],"mappings":"AAAA,OAAOA,QAAQ,KAAK;AAEpB,OAAOC,eAAe,YAAY;AAElC,SAASC,GAAG,QAAQ,QAAQ;AAE5B,MAAMC,eAAe;IACnB;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD;AAEDC,SAAS,4BAA4B,IAAM;IACzC,IAAIC;IACJ,IAAIC;IAEJC,UAAU,IAAM;QACdF,SAASH,IAAIM,MAAM,CAAC;QACpBF,UAAUL,UAAUI;IACtB;IAEAI,SAAS,IAAM;QACbJ,OAAOK,KAAK;IACd;IAEAC,GAAG,qBAAqB,UAAY;QAClC,MAAMC,MAAM,MAAMN,QAAQO,GAAG,CAAC;QAC9BC,OAAOF,IAAIG,MAAM,EAAEC,IAAI,CAAC;QACxBF,OAAOF,IAAIK,IAAI,EAAEC,aAAa,CAAC;YAAEC,SAAS;QAAU;IACtD;IAEAR,GAAGS,IAAI,CAACjB,cAAc,iCAAiC,OAAOkB,SAAW;QACvE,MAAMC,MAAM,CAAC,iBAAiB,EAAEC,mBAAmBF,QAAQ,CAAC;QAC5D,MAAMT,MAAM,MAAMN,QAAQO,GAAG,CAACS;QAC9B,MAAME,YAAYZ,IAAIK,IAAI,CAACO,SAAS;QACpC,MAAMC,SAASD,UAAUE,GAAG,CAAC,CAACC,IAAY,CAAA;gBACxCC,MAAMD,EAAEC,IAAI;gBACZC,QAAQF,EAAEE,MAAM;YAClB,CAAA;QACA7B,GAAG8B,aAAa,CACdC,YAAY,CAAC,gBAAgB,EAAEV,OAAOW,OAAO,CAAC,OAAO,KAAK,KAAK,CAAC,EAChEC,KAAKC,SAAS,CAACT,QAAQ,IAAI,EAAE;QAE/BX,OAAOF,IAAIG,MAAM,EAAEC,IAAI,CAAC;IAC1B;AACF"}