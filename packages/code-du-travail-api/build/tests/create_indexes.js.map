{"version":3,"sources":["../../src/tests/create_indexes.js"],"sourcesContent":["import {\n  createIndex,\n  documentMapping,\n  DOCUMENTS,\n  indexDocumentsBatched,\n  suggestionMapping,\n  SUGGESTIONS,\n  version,\n} from \"@socialgouv/cdtn-elasticsearch\";\n\nimport client from \"../conf/elasticsearch\";\nimport { CDTN_ADMIN_VERSION } from \"../routes/v1.prefix\";\nimport documents from \"./cdtn_document.data.json\";\nimport suggestions from \"./suggestions_data.json\";\n\nconst ES_INDEX_PREFIX = process.env.ES_INDEX_PREFIX ?? \"cdtn_test\";\nconst documentsIndexName = `${ES_INDEX_PREFIX}-${CDTN_ADMIN_VERSION}_${DOCUMENTS}`;\nconst suggestionsIndexName = `${ES_INDEX_PREFIX}-${CDTN_ADMIN_VERSION}_${SUGGESTIONS}`;\n\nasync function main() {\n  await version({ client });\n  await createIndex({\n    client,\n    indexName: documentsIndexName,\n    mappings: documentMapping,\n  });\n  await indexDocumentsBatched({\n    client,\n    documents: documents,\n    indexName: documentsIndexName,\n  });\n\n  await createIndex({\n    client,\n    indexName: suggestionsIndexName,\n    mappings: suggestionMapping,\n  });\n  await indexDocumentsBatched({\n    client,\n    documents: suggestions,\n    indexName: suggestionsIndexName,\n  });\n}\n\nmain();\n"],"names":["createIndex","documentMapping","DOCUMENTS","indexDocumentsBatched","suggestionMapping","SUGGESTIONS","version","client","CDTN_ADMIN_VERSION","documents","suggestions","ES_INDEX_PREFIX","process","env","documentsIndexName","suggestionsIndexName","main","indexName","mappings"],"mappings":"AAAA,SACEA,WAAW,EACXC,eAAe,EACfC,SAAS,EACTC,qBAAqB,EACrBC,iBAAiB,EACjBC,WAAW,EACXC,OAAO,QACF,iCAAiC;AAExC,OAAOC,YAAY,wBAAwB;AAC3C,SAASC,kBAAkB,QAAQ,sBAAsB;AACzD,OAAOC,eAAe,4BAA4B;AAClD,OAAOC,iBAAiB,0BAA0B;AAElD,MAAMC,kBAAkBC,QAAQC,GAAG,CAACF,eAAe,IAAI;AACvD,MAAMG,qBAAqB,CAAC,EAAEH,gBAAgB,CAAC,EAAEH,mBAAmB,CAAC,EAAEN,UAAU,CAAC;AAClF,MAAMa,uBAAuB,CAAC,EAAEJ,gBAAgB,CAAC,EAAEH,mBAAmB,CAAC,EAAEH,YAAY,CAAC;AAEtF,eAAeW,OAAO;IACpB,MAAMV,QAAQ;QAAEC;IAAO;IACvB,MAAMP,YAAY;QAChBO;QACAU,WAAWH;QACXI,UAAUjB;IACZ;IACA,MAAME,sBAAsB;QAC1BI;QACAE,WAAWA;QACXQ,WAAWH;IACb;IAEA,MAAMd,YAAY;QAChBO;QACAU,WAAWF;QACXG,UAAUd;IACZ;IACA,MAAMD,sBAAsB;QAC1BI;QACAE,WAAWC;QACXO,WAAWF;IACb;AACF;AAEAC"}